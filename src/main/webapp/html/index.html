<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="../font/iconfont.css"/>
	<link rel="stylesheet" href="../css/framework.css"/>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="../css/reset.css"> <!-- CSS reset -->
	<link rel="stylesheet" href="../css/style.css"> <!-- Resource style -->
	<link rel="stylesheet" href="../css/index.css">
	<!-- 弹窗 -->
	<link href="../css/xtiper.css" type="text/css" rel="stylesheet" />
	<link rel="shortcut icon" href="#"/>
	<script src="../js/xtiper.min.js" type="text/javascript"></script>
	<style>
		*{
			margin: 0 ;
			padding: 0;
			list-style: none;
		}
		html{
			height: 100%;
			width: 100%;
		}
		body{
			width: 100%;
			height: 100%;
			background: #4F4F4F;
			min-width: 530px;
			/* 可以往上调，根据需求改，最小555px */
			min-height: 1500px;
		}
		/*		main*/
		.main{
			width: 1189px;
			display:block;
			left: 160px;
			height: 750px;
			margin: 0 auto;
		}
		
	</style>
    <title>Document</title>
</head>
<body>
	 <!-- 头部 -->
	<div class="header">
		<div class="portrait">
			<span class="iconfont icon-touxiang-kong" style="display: block; color: #fff;text-align: center; width: 100%;height: 70%; font-size: 55px; float: left;"></span>
			<p class="header-username">林瑞鑫</p>
		</div>
		<div class="header-title">
			<p class="title-content">社团管理系统</p>
		</div>
		<div class="header-right">
			<div class="right-email">
				<span class="iconfont icon-changyongtubiao-xianxingdaochu-zhuanqu-" style="display: block;font-size: 30px; color: #fff;text-align: center;margin-top: 24px;"></span>
				<div class="email-menu">
					<ul class="email-ul">
						<li>任务</li>
						<li>申请</li>
						<li>公告</li>
					</ul>
				</div>
			</div>
			<div class="right-logout">
				<div id="logout" class="logout-content">
					<p class="font-logout">退出</p>
					<span class="iconfont icon-dengchu" style=" width: 47px; float:right; font-size: 30px; padding-top: 3px;padding-bottom: 4px;color: #fff;"></span>
				</div>
			</div>
		</div>
	</div>
	<!-- 内容 -->
	<div class="content">
		<!-- 左侧导航 -->
		<div class="nav">
			<ul class="nav-ul">
				<li id="jump-index" class="jump">首页</li>
				<li id="jump-checkIn" class="jump">打卡</li>
				<li id="jump-task" class="jump">任务</li>
				<li id="jump-share" class="jump">资源分享</li>
				<li id="jump-apply" class="jump">申请</li>
				<li id="jump-notic" class="jump">公告</li>
			</ul>
		</div>
		<!-- 主体内容 -->
		<div class="main-out">
			<!--	主体内容-->
	<div class="main">
		<!--		进度-->
				<div class="progress">
					<ul class="progess-ul">
		<!--				本月签到天数-->
						<li class="progress-clockIn">
							<span class="iconfont icon-naozhong" style="font-size: 35px; margin-left: 40px; color: #FFFFFF; position: relative;top: 37px; padding: 18px; background: #FDA423; border-radius: 50%"></span>
							<p style="font-weight: bold; font-size: 18px; color: #fff; margin-left: 127px; margin-top: -17px;">本月签到</p>
							<p id="checkInCount" style="font-weight: bold; font-size: 33px; color: #54E4E7; width: 72px; text-align: center; margin-left: 127px; margin-top: 3px">0</p>
						</li>
		<!--				剩余任务数量-->
						<li class="progress-task">
							<span class="iconfont icon-renwu" style="font-size: 35px; margin-left: 40px; color: #FFFFFF; position: relative;top: 37px; padding: 18px; background: #4372E0; border-radius: 50%;"></span>
							<p style="font-weight: bold; font-size: 18px; color: #fff; margin-left: 127px; margin-top: -17px;">剩余任务</p>
							<p id="RemTask" style="font-weight: bold; font-size: 33px; color: #54E4E7; width: 72px; text-align: center; margin-left: 127px; margin-top: 3px">0</p>
						</li>
		<!--				申请进度-->
						<li class="progress-apply">
							<span class="iconfont icon-lianjie" style="font-size: 35px; margin-left: 40px; color: #FFFFFF; position: relative;top: 37px; padding: 18px; background: #4EED88; border-radius: 50%"></span>
							<p style="font-weight: bold; font-size: 18px; color: #fff; margin-left: 127px; margin-top: -17px;">申请进度</p>
							<p id="applyProgress" style="font-weight: bold; font-size: 33px; color: #54E4E7; width: 72px; text-align: center; margin-left: 127px; margin-top: 3px">0%</p>
						</li>
		<!--				今日资源-->
						<li class="progress-resources">
							<span class="iconfont icon-kucun" style="font-size: 35px; margin-left: 40px; color: #FFFFFF; position: relative;top: 37px; padding: 18px; background: #C34EF0; border-radius: 50%"></span>
							<p style="font-weight: bold; font-size: 18px; color: #fff; margin-left: 127px; margin-top: -17px;">今日资源</p>
							<p id="todayShare" style="font-weight: bold; font-size: 33px; color: #54E4E7; width: 72px; text-align: center; margin-left: 127px; margin-top: 3px">0</p>
						</li>
					</ul>
				</div>
				<div class="line2" style="width: 85%; height: 220px; margin: 0 auto; margin-top: 50px;">
			<!--		打卡-->
					<div class="clockIn">
			<!--			时钟-->
						<div class='face'>
							<div class='hour-hand'></div>
							<div class='minute-hand'></div>
							<div class='seconds-hand'></div>
							<div class='center'></div>
						</div>
						<div class="clockInRight">
							<center>
								<li><input type="button" class="clockIn-btn" value="打卡"></li>
								<li><input type="button" class="change-btn" value="变更"></li>
							</center>
						</div>
					</div>
			<!--		资金申请表单-->
					<div class="applyForFunding">
						<form class="applyForFunding-form" autocomplete="off">
							<ul class="applyForFunding-ul1">
								<li style="color: #fff; font-weight: bold; font-size: 20px; margin-bottom: 10px;">资金申请</li>
								<li style="margin-top: 20px;" class="ul1-money"><input type="text" class="input-money" name="money" id="input-money" placeholder="请输入金额"/></li>
								<li style="border-bottom: 1px dashed rgb(85, 85, 85); margin-top: 12px;"></li>
								<li style="margin-top: 13px;" class="ul1-reason"><input type="text" class="input-reason" id="input-reason" name="reason" placeholder="请输入理由"/></li>
							</ul>
							<ul class="applyForFunding-ul2">
								<li>
										<input type="button" class="applySubmit" id="applySubmit" value="提交"/>
								</li>
							</ul>
						</form>
					</div>
					
		<!--			用户详细信息-->
					<div class="line2-userInfo">
						<span class="iconfont icon-touxiang-kong" style="font-size: 60px; color: #fff; position: relative; left: 97px; top: 20px;"></span>
						<ul class="userInfo-ul1">
							<li class="userInfo-name">林瑞鑫</li>
							<li class="userInfo-role">普通员工</li>
						</ul>
						<ul class="userInfo-ul2">
							<li>
								<span class="userInfo-span1">
									<p id="userInfo-RemTask" class="span1-content" style="color: #fff; text-align: center; font-size: 28px; padding-top: 4px; font-weight: bold;">0</p>
									<p class="span1-describe" style="color: #757575; text-align: center; font-size: 10px; padding-top: 1px;">任务</p>
								</span>
							</li>
							<li>
								<span class="userInfo-span2">
									<p id="shareCount" class="span2-content" style="color: #fff; text-align: center; font-size: 28px; padding-top: 4px;font-weight: bold;">0</p>
									<p class="span2-describe" style="color: #757575; text-align: center; font-size: 10px; padding-top: 1px;">贡献</p>
								</span>
							</li>
							<li>
								<span class="userInfo-span3">
									<p id="applyCount" class="span3-content" style="color: #fff; text-align: center; font-size: 28px; padding-top: 4px;font-weight: bold;">0</p>
									<p class="span3-describe" style="color: #757575; text-align: center; font-size: 10px; padding-top: 1px;">申请</p>
								</span>
							</li>
						</ul>
					</div>
				</div>
				<div class="line3">
					
		<!--			板块-->
		<!--			总体-->
					<div class="cd-pricing-container cd-has-margins">
		<!--				按钮-->
						<div class="cd-pricing-switcher">
		<!--					按钮文字-->
							<p class="fieldset">
								<input type="radio" name="duration-2" value="monthly" id="monthly-2" checked>
								<label for="monthly-2">第一页</label>
								<input type="radio" name="duration-2" value="yearly" id="yearly-2">
								<label for="yearly-2">第二页</label>
								<span class="cd-switch"></span>
							</p>
						</div> <!-- .cd-pricing-switcher -->
		<!--				中间三个板块-->
						<ul class="cd-pricing-list cd-bounce-invert">
							<li>
								<ul class="cd-pricing-wrapper">
									<li data-type="monthly" class="is-visible">
										<header class="cd-pricing-header">
											<h2 id="card1-userName">Basic</h2>
		
											<div class="cd-price">
												<span id="card1-year" class="cd-currency">$</span>
												<span id="card1-day" class="cd-value">30</span>
												<span id="card1-month" class="cd-duration">mo</span>
											</div>
										</header> <!-- .cd-pricing-header -->
		
										<div class="cd-pricing-body">
											<ul class="cd-pricing-features">
												<li id="card1-fileName">Memory</li>
												<!--<li><em>1</em> User</li>
												<li><em>1</em> Website</li>
												<li><em>1</em> Domain</li>
												<li><em>Unlimited</em> Bandwidth</li>
												<li><em>24/7</em> Support</li>-->
											</ul>
										</div> <!-- .cd-pricing-body -->
		
										<footer class="cd-pricing-footer">
											<a id="card1-btn" class="cd-select" href="#">下载</a>
										</footer>  <!-- .cd-pricing-footer -->
									</li>
		
									<li data-type="yearly" class="is-hidden">
										<header class="cd-pricing-header">
											<h2 id="card4-userName">Basic</h2>
		
											<div class="cd-price">
												<span id="card4-year" class="cd-currency">$</span>
												<span id="card4-day" class="cd-value">320</span>
												<span id="card4-month" class="cd-duration">yr</span>
											</div>
										</header> <!-- .cd-pricing-header -->
		
										<div class="cd-pricing-body">
											<ul class="cd-pricing-features">
												<li id="card4-fileName">Memory</li>
												<!--<li><em>1</em> User</li>
												<li><em>1</em> Website</li>
												<li><em>1</em> Domain</li>
												<li><em>Unlimited</em> Bandwidth</li>
												<li><em>24/7</em> Support</li>-->
											</ul>
										</div> <!-- .cd-pricing-body -->
		
										<footer class="cd-pricing-footer">
											<a id="card4-btn"  class="cd-select" href="#">下载</a>
										</footer>  <!-- .cd-pricing-footer -->
									</li>
								</ul> <!-- .cd-pricing-wrapper -->
							</li>
		
							<li class="cd-popular">
								<ul class="cd-pricing-wrapper">
									<li data-type="monthly" class="is-visible">
										<header class="cd-pricing-header">
											<h2 id="card2-userName">Popular</h2>
											<div class="cd-price">
												<span id="card2-year" class="cd-currency">$</span>
												<span id="card2-day" class="cd-value">60</span>
												<span id="card2-month" class="cd-duration">mo</span>
											</div>
										</header> <!-- .cd-pricing-header -->
		
										<div class="cd-pricing-body">
											<ul class="cd-pricing-features">
												<li id="card2-fileName">Memory</li>
												<!--<li><em>3</em> Users</li>
												<li><em>5</em> Websites</li>
												<li><em>7</em> Domains</li>
												<li><em>Unlimited</em> Bandwidth</li>
												<li><em>24/7</em> Support</li>-->
											</ul>
										</div> <!-- .cd-pricing-body -->
		
										<footer class="cd-pricing-footer">
											<a id="card2-btn"  class="cd-select" href="#">下载</a>
										</footer>  <!-- .cd-pricing-footer -->
									</li>
		
									<li data-type="yearly" class="is-hidden">
										<header class="cd-pricing-header">
											<h2 id="card5-userName">Popular</h2>
		
											<div class="cd-price">
												<span id="card5-year" class="cd-currency">$</span>
												<span id="card5-day" class="cd-value">630</span>
												<span id="card5-month" class="cd-duration">yr</span>
											</div>
										</header> <!-- .cd-pricing-header -->
		
										<div class="cd-pricing-body">
											<ul class="cd-pricing-features">
												<li id="card5-fileName">Memory</li>
												<!--<li><em>3</em> Users</li>
												<li><em>5</em> Websites</li>
												<li><em>7</em> Domains</li>
												<li><em>Unlimited</em> Bandwidth</li>
												<li><em>24/7</em> Support</li>-->
											</ul>
										</div> <!-- .cd-pricing-body -->
		
										<footer class="cd-pricing-footer">
											<a id="card5-btn"  class="cd-select" href="#">下载</a>
										</footer>  <!-- .cd-pricing-footer -->
									</li>
								</ul> <!-- .cd-pricing-wrapper -->
							</li>
		
							<li>
								<ul class="cd-pricing-wrapper">
									<li data-type="monthly" class="is-visible">
										<header class="cd-pricing-header">
											<h2 id="card3-userName">Premier</h2>
		
											<div class="cd-price">
												<span id="card3-year" class="cd-currency">$</span>
												<span id="card3-day" class="cd-value">90</span>
												<span id="card3-month" class="cd-duration">mo</span>
											</div>
										</header> <!-- .cd-pricing-header -->
		
										<div class="cd-pricing-body">
											<ul class="cd-pricing-features">
												<li id="card3-fileName">Memory</li>
												<!--<li><em>5</em> Users</li>
												<li><em>10</em> Websites</li>
												<li><em>10</em> Domains</li>
												<li><em>Unlimited</em> Bandwidth</li>
												<li><em>24/7</em> Support</li>-->
											</ul>
										</div> <!-- .cd-pricing-body -->
		
										<footer class="cd-pricing-footer">
											<a id="card3-btn"  class="cd-select" href="#">下载</a>
										</footer>  <!-- .cd-pricing-footer -->
									</li>
		
									<li data-type="yearly" class="is-hidden">
										<header class="cd-pricing-header">
											<h2 id="card6-userName">Premier</h2>
		
											<div class="cd-price">
												<span id="card6-year" class="cd-currency">$</span>
												<span id="card6-day" class="cd-value">950</span>
												<span id="card6-month" class="cd-duration">yr</span>
											</div>
										</header> <!-- .cd-pricing-header -->
		
										<div class="cd-pricing-body">
											<ul class="cd-pricing-features">
												<li id="card6-fileName">Memory</li>
												<!--<li><em>5</em> Users</li>
												<li><em>10</em> Websites</li>
												<li><em>10</em> Domains</li>
												<li><em>Unlimited</em> Bandwidth</li>
												<li><em>24/7</em> Support</li>-->
											</ul>
										</div> <!-- .cd-pricing-body -->
		
										<footer class="cd-pricing-footer">
											<a id="card6-btn"  class="cd-select" href="#">下载</a>
										</footer>  <!-- .cd-pricing-footer -->
									</li>
								</ul> <!-- .cd-pricing-wrapper -->
							</li>
						</ul> <!-- .cd-pricing-list -->
					</div> <!-- .cd-pricing-container -->			
				
				</div>
			</div>
		</div>
	</div>
</body>
</html>
<script src="../js/jquery-1.11.0.min.js"></script>
<script src="../js/main.js"></script> <!-- Resource jQuery -->
<script src="../js/modernizr.js"></script> <!-- Modernizr -->
<script type="text/javascript" src="../js/plugin.js"></script>
<script type="text/javascript" src="../js/jump.js"></script>
<script type="text/javascript">
	window.onload = function(){
		$.ajax({
			url:"../loadIndexServlet",
			method:"get"
		}).done(function(data){
			if(data.status == 0){
				var indexInfo = data.obj;
				// 将数据渲染到主页
				$("#checkInCount").text(indexInfo.checkInCount);
				$("#RemTask").text(indexInfo.remTask);
				$("#applyProgress").text(indexInfo.applyProgress);
				$("#todayShare").text(indexInfo.todayShare);
				$("#userInfo-RemTask").text(indexInfo.remTask);
				$("#shareCount").text(indexInfo.shareCount);
				$("#applyCount").text(indexInfo.applyCount);
				// 将资源文件渲染到主页
				var shares = indexInfo.shares;
				for(var i = 0;i<shares.length;i++){
					var share = shares[i];
					var fileRealName = share.fileName;
					var prefix = fileRealName.substring(0,4);
					var fileName = fileRealName.substring(4,fileRealName.length);
					var year = share.uploadTime.split("-")[0];
					var month = share.uploadTime.split("-")[1];
					var day = share.uploadTime.split("-")[2];
					$("#card"+(i+1)+"-userName").text(share.userName);
					$("#card"+(i+1)+"-year").text(year);
					$("#card"+(i+1)+"-month").text(month);
					$("#card"+(i+1)+"-day").text(day);
					$("#card"+(i+1)+"-fileName").text(fileName);
					$("#card"+(i+1)+"-fileName").attr("name",prefix);
					$("#card"+(i+1)+"-btn").attr("href","../downLoadFileServlet?fileName="+fileRealName);
				}
			}else if(data.status == 1){
				xtip.msg(data.msg,{icon:'e',type:'w'});
			}
		}).fail(function(){
			xtip.msg("请求失败",{icon:'e',type:'w'});
		})
	}
	var isPass = false;
	$("#input-money").blur(function(){
		var money = $("#input-money").val();
		console.log(money);
		if(/^[0-9]{1,4}$/.test(money)){
			$("#input-money").css("color","white");
			isPass = true;
		}else{
			$("#input-money").css("color","red");
			isPass = false;
			xtip.msg("请输入四位以内的数",{icon:'e',type:'w'});
		}
	})
	$("#input-reason").blur(function(){
		var reason = $("#input-reason").val();
		console.log(reason);
		if(reason == null || reason == "" || reason.trim() == ""){
			$("#input-reason").css("color","red");
			isPass = false;
			xtip.msg("请输入申请理由",{icon:'e',type:'w'});
		}else{
			$("#input-reason").css("color","white");
			isPass = true;
		}
	})
	function checkAll(){
		var money = $("#input-money");
		var reason = $("#input-reason");
		if(money.val() == null || money.val() == "" || money.val().trim() == ""){
			xtip.msg("请检查格式",{icon:'e',type:'w'});
			isPass = false;
		}
		if(reason.val() == null || reason.val() == "" || reason.val().trim() == ""){
			xtip.msg("请检查格式",{icon:'e',type:'w'});
			isPass = false;
		}
		if(money.css('color') == "red"){
			xtip.msg("请检查格式",{icon:'e',type:'w'});
			isPass = false;
		}
		if(reason.css('color') == "red"){
			xtip.msg("请检查格式",{icon:'e',type:'w'});
			isPass = false;
		}
		if(isPass){
			return true;
		}else{
			return false;
		}
	}
	$("#applySubmit").click(function(){
		if(checkAll()){
			$.ajax({
				url:"../applyServlet",
				data:{"money":$("#input-money").val(),"reason":$("#input-reason").val()}
			}).done(function(data){
				if(data.status == 0){
					alert(data.msg);
				}else if(data.status ==1){
					xtip.msg(data.msg,{icon:'e',type:'w'});
				}
			}).fail(function(){
				xtip.msg("请求失败",{icon:'e',type:'w'});
			})
		}
	})

//	clock
	$(document).ready(function() {
    $('body').append('<div class="time">');

    Number.prototype.map = function(in_min, in_max, out_min, out_max) {
        return (this - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
    }

    function rotate(element, degrees) {
        element.css({
            '-webkit-transform': 'rotate(' + degrees + 'deg)',
            '-moz-transform': 'rotate(' + degrees + 'deg)',
            '-ms-transform': 'rotate(' + degrees + 'deg)',
            'transform': 'rotate(' + degrees + 'deg)'
        });
    }

    function setTime() {
        var date = new Date();
        var mil = date.getMilliseconds();
        var sec = date.getSeconds();
        var min = date.getMinutes();
        var hrs = date.getHours();

        var mapSec = sec.map(0, 59, 0, 360);
        var mapMin = min.map(0, 59, 0, 360);
        var mapHrs = hrs.map(0, 11, 0, 360);

        if (sec == 0) {
            $('.seconds-hand').removeClass('smooth');
        } else {
            $('.seconds-hand').addClass('smooth');
        }

        if (min == 0) {
            $('.minute-hand').removeClass('smooth');
        } else {
            $('.minute-hand').addClass('smooth');
        }

        if (hrs == 0) {
            $('.hour-hand').removeClass('smooth');
        } else {
            $('.hour-hand').addClass('smooth');
        }

        rotate($('.seconds-hand'), mapSec);
        rotate($('.minute-hand'), mapMin);
        rotate($('.hour-hand'), mapHrs);
    }

    setInterval(function() {
        setTime()
    }, 1);
});

</script>